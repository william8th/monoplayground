plugins {
    id "org.jetbrains.kotlin.jvm" version "1.3.40"
}

group "com.williamheng"
version "1.0-SNAPSHOT"

subprojects {
    ext {
        kotlinVersion = "1.3.40"
        groovyVersion = "2.5.7"
        junitVersion = "4.12"
        jdbiVersion = "3.8.2"
        ktorVersion = "1.2.3"

        cucumberVersion = "4.7.1"
    }

    repositories {
        mavenLocal()
        mavenCentral()
        jcenter()
    }

    ext.libs = [
            hikari: [
                    "com.zaxxer:HikariCP:2.7.9"
            ],
            jdbi: [
                    "org.jdbi:jdbi3-core:$jdbiVersion",
                    "org.jdbi:jdbi3-sqlobject:$jdbiVersion",
                    "org.jdbi:jdbi3-kotlin:$jdbiVersion"
            ],
            jdbiTesting: [
                    "org.jdbi:jdbi3-testing:$jdbiVersion",
                    "com.opentable.components:otj-pg-embedded:0.11.3"
            ]
    ]

    apply plugin: "kotlin"
    apply plugin: "groovy"

    dependencies {
        implementation "org.jetbrains.kotlin:kotlin-stdlib-jdk8:$kotlinVersion"
        implementation "org.codehaus.groovy:groovy:$groovyVersion"

        testImplementation "junit:junit:$junitVersion"

        runtime 'ch.qos.logback:logback-classic:1.2.3'
    }

    compileKotlin {
        kotlinOptions.jvmTarget = "1.8"
    }

    compileTestKotlin {
        kotlinOptions.jvmTarget = "1.8"
    }

    compileGroovy {
        dependsOn compileKotlin
        classpath += files(compileKotlin.destinationDir)
    }

}

